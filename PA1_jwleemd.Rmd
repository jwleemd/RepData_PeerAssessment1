---
title: "Reproducible Research: Peer Assessment 1"
output: 
html_document:
keep_md: true
---


The activity data is loaded into R using read.csv() command. 

```{r read_data, echo=TRUE}

activity_data <- read.csv("activity.csv")
```

Then, the total number of steps taken per day is calculated.

```{r, echo=TRUE}
total_steps_per_day <- aggregate(steps~date, data=activity_data, FUN=sum)
```
The histogram for total steps per day is plotted, and the mean and median for total steps per day are reported.

```{r histogram, echo=TRUE}
hist(total_steps_per_day$steps, 
     main="Histogram of total number of steps per day",
     ylim = c(0,30),
     xlab="Total number of steps per day")
```


```{r, mean ane median for total steps per day, echo=TRUE}
mean(total_steps_per_day$steps)
median(total_steps_per_day$steps)
```

### What is the average daily activity pattern?

The av
```{r, echo=TRUE}

average_steps_per_interval <- aggregate(steps ~ interval, 
                                        data=activity_data, 
                                        FUN=mean, na.rm=T)

plot(steps ~ interval, data=average_steps_per_interval, type="l")
average_steps_per_interval$interval[which.max(average_steps_per_interval$steps)]

```

## Imputing missing values

#Calculate and report the total number of missing values in the dataset

```{r, echo=TRUE}
sum(apply(activity_data, 1, function(x) any(is.na(x))))
```
#Devise a strategy for filling in all of the missing values in the dataset. The strategy does not need to be sophisticated. For example, you could use the mean/median for that day, or the mean for that 5-minute interval, etc.

#In the following code, the missing values are being replaced by the mean for that 5-minute interval.

```{r, echo=TRUE}
old <- activity_data
for (i in 1:nrow(activity_data)) {
        
        if (is.na(activity_data[i,"steps"])) {
                
                activity_data[i, "steps"] <- average_steps_per_interval$steps[average_steps_per_interval$interval == activity_data[i, "interval"]]
                
        }
}
activity_data_new <- activity_data
activity_data_old <- old

total_steps_per_day_new <- aggregate(steps~date, data=activity_data_new, FUN=sum)
hist(total_steps_per_day_new$steps, 
     main="Histogram of total number of steps per day",
     ylim = c(0,40),
     xlab="Total number of steps per day")
mean(total_steps_per_day_new$steps)
median(total_steps_per_day_new$steps)

```

## Are there differences in activity patterns between weekdays and weekends?
```{r, echo = TRUE}

dates <- weekdays(as.Date(activity_data_new$date))
weekdays <- ifelse(dates%in%c("Saturday","Sunday"), "Weekend","Weekdays")
activity_data_new$weekdays <- weekdays
activity_data_new$weekdays <- as.factor(activity_data_new$weekdays)

weekdays_data <- activity_data_new[activity_data_new$weekdays=="Weekdays",]
weekend_data <- activity_data_new[activity_data_new$weekdays=="Weekend",]

average_steps_per_interval_weekdays <- aggregate(steps ~ interval, 
                                        data=weekdays_data, 
                                        FUN=mean, na.rm=T)

plot(steps ~ interval, data=average_steps_per_interval_weekdays, type="l", col="blue",
     main="Mean steps per inverval")

average_steps_per_interval_weekend <- aggregate(steps ~ interval, 
                                        data=weekend_data, 
                                        FUN=mean, na.rm=T)

lines(steps ~ interval, data=average_steps_per_interval_weekend, type="l", col="red")
legend("topright", c("Weekdays","Weekend"), col=c("blue","red"), pch=19)

```